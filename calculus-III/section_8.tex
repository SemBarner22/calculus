\chapter{Криволинейные интегралы}

\section{Интеграл по кусочно-гладкому пути}

\begin{definition}
    Пусть $E \subseteq \Rm$ открыто, тогда $V \colon E \to \Rm$ будем
    называть \textit{векторным полем}. По умолчанию $V \in C(E)$.
\end{definition}

\begin{definition}(Интеграл векторного поля по кусочно-гладкому пути)

    Пусть $V$ - векторное поле, $\gamma \colon [a, b] \to E$ --- кусочно-гладкий
    путь, тогда \textit{интегралом векторного поля по этому пути} называется
\[
    I(V, \gamma) \defeq \int_a^b{\langle V(\gamma(t)), \gamma'(t) \rangle dt}
\]
\end{definition}

\begin{remark}
    Предыдущее определение можно переписать в нескольких эквивалентных формах:
\begin{align*}
    I(V, \gamma) &= \int_a^b{\langle V(\gamma(t)), \gamma'(t) \rangle dt}\\
    &= \int_a^b{\sum_{i = 1}^{m}{V_i(\gamma(t)) ~ \gamma'(t)} dt}\\
    &\underset{\gamma \rightarrow x}{=}
    \int_a^b{\sum_{i = 1}^{m}{V_i(x(t)) ~ x_i'(t)} dt}\\
    &= \int_a^b{\sum_{i = 1}^{m}{V_i dx_i}}
\end{align*}
\end{remark}

\begin{definition}
    Пусть $\gamma_1 \colon [a, b] \to \Rm$, $\gamma_2 \colon [c, d] \to \Rm$ ---
    пути, $\gamma_1(b) = \gamma_2(c)$, тогда определим \textit{произведение путей}
    $\gamma = \gamma_1 \gamma_2 \colon [a, d] \to \Rm$ следующим образом:
\[
    \gamma(t) = \begin{cases}
                    \gamma_1(t), t \in [a, b] \\
                    \gamma_2(t - b + c), t \in [b, b + d - c]
                \end{cases}
\]
\end{definition}

\begin{definition}
    \textit{Обратным путем} называется путь $\gamma^{-1}: t \mapsto \gamma(a + b -
    t)$.
\end{definition}

\begin{theorem}(О свойствах интеграла по кусочно-гладкому пути)

    \begin{itemize}
        \item[1.] Линейность по полю:
            $I(\a U + \b V, \gamma) = \a I(U, \gamma) + \b I(V, \gamma)$ для любых
            полей $U, V$, любого к-г пути $\gamma$ и любых $\a, \b \in \R$.
        \item[2.] Аддитивность при дроблении пути:
            $\gamma \colon [a, b] \to \Rm$, $a < c < b$, тогда \\
            $I(v, \gamma) = I(V, \gamma\big|_{[a, c]}) + I(V, \gamma\big|_{[c,
            b]})$.
        \item[3.] Замена параметра:
            пусть $\f \colon [p, q] \to [a, b]$ --- сюрьекция, причем $\f(p) = a$,
            $\f(q) = b$, $\f \in C^1$, тогда $I(V, \gamma) = I(V, \gamma \circ \f)$.
        \item[4.] Интеграл произведения путей:
            $I(V, \gamma_1 \gamma_2) = I(V, \gamma_1) + I(V, \gamma_2)$.
        \item[5.] $I(V, \gamma) = -I(V, \gamma^{-1})$.
        \item[6.] $\displaystyle |I(V, \gamma)| \leqslant \max_{x \in \gamma[a,
        b]}{\norm{V(x)}} \cdot l(\gamma)$.
    \end{itemize}
\end{theorem}
\begin{proof}
    \enewline
    \begin{itemize}
        \item[3.]
\begin{align*}
    I(V, \gamma) &= \int_a^b{\scp{V(\gamma(t)), \gamma'(t)}} \underset{t = \f(s)}{=}
    \int_p^q{\scp{V(\gamma(\f(s))), \gamma'(\f(s))} \f'(s) ~ds} \\ &=
    \int_p^q{\scp{V((\gamma \circ \f)(s)), (\gamma \circ \f)'(s)} ~ds} = I(V, \gamma \circ \f)
\end{align*}
        Поскольку любые две параметризации гладкого многообразия отличаются
        на диффеоморфизм, интеграл зависит только от носителя пути.

        \item[5.]
\begin{align*}
    I(V, \gamma^{-1}) &= \int_a^b{\scp{V(\gamma(a + b - t)), \gamma'(a + b - t)}
    \cdot (-1) ~dt} \\
    &\underset{\tau = a + b - t}{=} \int_a^b{\scp{V(\gamma(\tau)), \gamma'(\tau)} ~d\tau}
    = I(V, \gamma)
\end{align*}
        \item[6.]
\[
    \left|I(V, \gamma)\right| \leqslant \int_a^b{\left|\scp{V(\gamma), \gamma'}\right|}
    \leqslant \int_a^b{\norm{V(\gamma)} \cdot \norm{\gamma'}} \leqslant
    \max_{\gamma}{\norm{V(\gamma)}} \cdot \int_a^b{\norm{\gamma'}}
\]
    \end{itemize}
\end{proof}

\section{Потенциальные векторные поля}

\begin{definition}
    Пусть $\Od$ --- область в $\Rm$, $V \colon \Od \to \Rm \in C$, тогда поле
    $V$ называется \textit{потенциальным}, если оно является градиентом какого-то
    отображения, то есть $\exists f \in C^1(\Od, \R)\colon~ V = \operatorname{grad}
    f$.
\end{definition}

\begin{remark}
    Пусть $f_1$, $f_2$ --- отображения из определения потенциальности поля $V$.
    Тогда $f_1 - f_2 = c \in \R$.
\end{remark}

\begin{theorem}(Обобщенная формула Ньютона-Лейбница)

    Пусть $V \colon \Od \to \Rm$ --- потенциальное поле с потенциалом $f$,
    $\gamma \colon [a, b] \to \Od$ --- кусочно-гладкий путь, $A = \gamma(a)$,
    $B = \gamma(b)$. Тогда
\[
    I(V, \gamma) = f(B) - f(A)
\]
\end{theorem}
\begin{proof}
    Докажем теорему для гладкого (не кусочно) пути. Тогда кусочно-гладкий путь
    разобъем на гладкие пути и посчитаем интеграл как сумму интегралов по этим
    путям. Сумма будет телескопической, получится заявленная формула.

    Пусть $\f(t) = f(\gamma(t))$. Тогда
\[
    \f'(t) = f'(\gamma(t)) \cdot \gamma'(t) = V(\gamma(t)) \cdot \gamma'(t) =
    \scp{V(\gamma(t)), \gamma'(t)}
\]
    То есть $\f$ --- первообразная подынтегрального выражения. Тогда работает
    обычная формула Ньютона-Лейбница.
\end{proof}

\begin{definition}
    Интеграл векторного поля \textit{не зависит от пути} в $\Od$, если $\forall A, B~
    \forall \gamma_1, \gamma_2$ кусочно-гладких путей из $A$ в $B$~ $I(V, \gamma_1)
    = I(V, \gamma_2)$.
\end{definition}

\begin{lemma}
    Пусть $\Od$ --- область, $A \in \Od$, тогда $\forall \x \in \Od~ \exists
    \gamma_\x \colon A \rightsquigarrow \x$ --- кусочно-гладкий.
\end{lemma}
\begin{proof}
    Пусть $M_A = \{\, \x \in \Od \mid \exists \gamma_\x \,\}$, где $\gamma_\x$
    --- путь из формулировки. Тогда $M_A$ открыто. Действительно, пусть
    $\x \in \Od\colon \exists \gamma_\x$. Тогда, поскольку $\Od$ открыто,
    $\exists U(\x) \subseteq \Od$. Но тогда $\forall \y \in U(\x)~ \exists \gamma_\y$,
    получаемый произведением пути $\gamma_\x$ и прямого пути из $\x$ в $\y$.

    Рассмотрим теперь множество $\Od \setminus M_A$: оно тоже открыто, так как
    если до точки $\x$ нет пути, то и до ближайших точек его тоже нет, иначе можно
    было бы достроить путь и до $\x$.

    Получается, мы разбили $\Od$ на два открытых непересекающихся множества.
    Поскольку $\Od$ связно, одно из них должно оказаться пустым. $M_A$ не пустое,
    потому что совершенно очевидно, что $A \in M_A$. Поэтому $M_A = \Od$,
    что и требовалось.
\end{proof}

\begin{theorem}(Характеризация потенциальных векторных полей в терминах интегралов)

    $V \colon \Od \to \Rm$, $\Od$ --- область в $\Rm$. Эквивалентны утверждения:
    \begin{itemize}
        \item[1.] $V$ --- потенциальное
        \item[2.] $I(V, \gamma)$ не зависит от пути
        \item[3.] $\forall$ кусочно-гладкой петли $\gamma~ I(V, \gamma) = 0$
    \end{itemize}
\end{theorem}
\begin{proof}
    \enewline
    \begin{itemize}
        \item[1 $\Lra$ 2] см. обобщенную теорему Ньютона-Лейбница.
        \item[2 $\Lra$ 3] Пусть $A$ --- точка на петле $\gamma_0$ и $\gamma$ ---
        постоянный путь в точке $A$. Тогда
\[
    I(V, \gamma_0) \overset{(2)}{=} I(V, \gamma) = 0
\]
        \item[3 $\Lra$ 2] Пусть $\gamma_1$, $\gamma_2$ --- пути из $A$ в $B$.
        Тогда рассмотрим кусочно-гладкую петлю \\ $\gamma_0 = \gamma_1 \gamma_2^{-1}$.
        Имеем:
\[
    0 = I(V, \gamma_0) = I(V, \gamma_1 \gamma_2^{-1}) = I(V, \gamma_1) + I(V, \gamma_2^{-1})
    = I(V, \gamma_1) - I(V, \gamma_2)
\]
        \item[2 $\Lra$ 1] Построим потанциал. Зафиксируем точку $A \in \Od$. Для
        каждой точки $\x \in \Od$ зафиксируем кусочно-гладкий путь $\gamma_{\x} \colon
        A \rightsquigarrow \x$ (см. лемму). Проверим, что $f(\x) = I(V, \gamma_{\x})$
        --- потанциал $V$. Для этого докажем, что $f'_{\x_1}(\x) = V_1(\x)$ (число
        $1$ здесь не играет никакой роли). Рассмотрим путь $\gamma_0 \colon
        t \mapsto \x + t h \elu_1$ для $t \in [0, 1]$, где $\elu_1$ --- стандартный
        базисный вектор. Тогда путь $\gamma_\x \gamma_0 \colon A \rightsquigarrow
        \x + h \elu_1$ --- тоже кусочно-гладкий. Из аддитивности интеграла по пути
        имеем:
\[
    f(\x + h \elu_1) - f(\x) = I(V, \gamma_\x \gamma_0) - I(V, \gamma_\x) = I(V, \gamma_0)
\]
        Здесь мы воспользовались (2) в первом переходе, позволив себе считать \\
        $f(\x + h \elu_1)$ не через $\gamma_{\x + h \elu_1}$, а через $\gamma_\x \gamma_0$.
        Далее
\begin{align*}
    I(V, \gamma_0) &= \int_0^1{\sum_{i = 1}^{m}{V_i ~d\x_i}}
    \underset{\substack{d\x_1 = hdt \\ d\x_i = 0, i \geqslant 2}}{=}
    \int_0^1{V_1(\x_1 + t h, \x_2, \ldots, \x_m) h ~dt}\\
    &= V_1(\x_1 + \theta h, \x_2, \ldots, \x_m) h \cdot |1 - 0|
\end{align*}
        Тогда
\[
    \frac{f(\x + h\elu_1) - f(\x)}{h} = V_1(\x_1 + \theta h, \x_2, \ldots, \x_m)
    \xrightarrow[h \to 0]{\text{непрер.}} V_1(\x_1, \ldots, \x_m)
\]
    \end{itemize}
\end{proof}

\newpage

\begin{figure}[ht]
    \centering
    \incfig{cpotential}
    \caption{Теорема о характеризации потенциальных векторных полей}
\end{figure}

\section{Локально потенциальные векторные поля}

\begin{lemma}
    $V \colon \Od \to \Rm$ --- гладкое потенциальное векторное поле. Тогда\\
    $\forall \x \in \Od~ \forall k, j~~
    \pderv{V_k}{\x_j}(\x) = \pderv{V_j}{\x_k}(\x)$
\end{lemma}

\begin{theorem}(Лемма Пуанкаре)

    Пусть $\Od \subseteq \Rm$ --- выпуклая область, $V \colon \Od \to \Rm \in C^1$,
    $\pderv{V_k}{\x_j}(\x) = \pderv{V_j}{\x_k}(\x)$, тогда $V$ потенциально.
\end{theorem}

\begin{definition}
    Поле $V \colon \Od \to \Rm$ называется \textit{локально потенциальным}, если
    оно потенциально в некоторой окрестности любой точки.
\end{definition}

\begin{corollary}(Лемма Пуанкаре)

    Пусть $\Od$ открыто в $\Rm$, $V \in C^1(\Od)$, $\pderv{V_k}{\x_j}(\x) =
    \pderv{V_j}{\x_k}(\x)$, тогда $V$ локально потенциально.
\end{corollary}

\section{Интеграл локально потенциального поля по непрерывному пути}

\begin{lemma}(О гусенице)

    Пусть $\Od \subseteq \Rm$ --- область, для всех $x$ задана окрестность $U(x)$,
    $\gamma \colon [a, b] \to \Od \in C(\Od)$, тогда существует такое дробление
    пути $a = t_0 < t_1 < \ldots < t_n = b$ и такие шары $B_k = B_k(x_k, r_k)
    \subseteq U(x_k)$, что $\forall k~ \im{\gamma\big|_{[t_k - 1, t_k]}} \subseteq
    B_k$.
\end{lemma}

\begin{definition}
    Объект из последней теоремы будем называть $V$-гусеницей.
\end{definition}

\begin{definition}
    Пути $\gamma_1, \gamma_2 \colon [a, b] \to \Od \in C(\Od)$ будем называть
    \textit{похожими}, если у них есть общая $V$-гусеница. При этом ограничение
    идем именно на гусеницу, то есть наборы $t_k$ могут быть разными.
\end{definition}

\begin{lemma}

    Пусть $V$ --- локально потенциальное векторное поле, $\gamma_1, \gamma_2$ ---
    похожие кусочно-гладкие пути, $\gamma_1(a) = \gamma_2(a)$,
    $\gamma_1(b) = \gamma_2(b)$, тогда $I(V, \gamma_1) = I(V, \gamma_2)$.
\end{lemma}

\begin{lemma}

    $C([a, b]) \ni \gamma \colon [a, b] \to \Od \subseteq \Rm$, $\Od$ --- область,
    тогда $\exists \delta > 0\colon~ \\ \text{Если } \gamma_1, \gamma_2 \colon [a,
    b] \to \Od\colon~ \forall t \in [a, b]~ |\gamma(t) - \gamma_1(t)| < \delta$,
    $|\gamma(t) - \gamma_2(t)| < \delta$, тогда $\gamma, \gamma_1, \gamma_2$ похожи
    друг на друга.
\end{lemma}

\begin{definition}(Интеграл локально потенциального поля по непрерывному пути)

    Пусть $\gamma$ --- непрерывный путь, $\gamma'$ --- любой кусочно-гладкий путь,
    удовлетворяющий предыдущей лемме. тогда положим $I(V, \gamma) = I(V, \gamma')$
\end{definition}


\section{Гомотопия}

\begin{definition}
    Рассмотрим два пути $\gamma_0, \gamma_1 \colon [a, b] \to \Od$.
    \textit{Гомотопией} путей $\gamma_0$, $\gamma_1$ называется отображение $\Gamma
    \colon [a, b] \times [0, 1] \to \Od \in C$, такое, что $\Gamma(t, 0) =
    \gamma_0(t)$ и $\Gamma(t, 1) = \gamma_1(t)$.
\end{definition}

\begin{definition}
    Гомотопия наывается \textit{связанной}, если $\gamma_0(a) = \gamma_1(a)$ и
    $\gamma_0(b) = \gamma_1(b)$.
\end{definition}

\begin{definition}
    Гомотопия называется \textit{петельной}, если $\forall u \in [0, 1]~
    \Gamma(a, u) = \Gamma(b, u)$.
\end{definition}

\begin{theorem}(Интегралы по связанно гомотопным путям)

    $V$ --- локально потенциальное поле, $\gamma_0$, $\gamma_1$ --- связянно
    гомотопные пути. Тогда $I(V, \gamma_0) = I(V, \gamma_1)$.
\end{theorem}

\begin{definition}
    Область называется \textit{односвязной} если любой замкнутый путь в ней
    гомотопен постоянному.
\end{definition}

\begin{theorem}

    Пусть $\Od$ --- односвязная область в $\Rm$, $V$ --- локально потенциальное
    векторное поле в $\Od$, тогда $V$ потенциально в $\Od$.
\end{theorem}

\begin{corollary}(Теорема Пуанкаре для односвязной области)

    $\pderv{V_k}{\x_j}(\x) = \pderv{V_j}{\x_k}(\x) \Lra$ поле потенциально.
\end{corollary}
